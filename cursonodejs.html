<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="shortcut icon" href="img/logo.png" type="image/png" />
	<meta charset="UTF-8">
	<title>Curso Node.js</title>
	<link rel="stylesheet" type="text/css" href="estilocurso.css"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>

	<style>
		code{
			background-color: lightgray;
		}
	</style>
</head>
<body>
	<div class="barra">
		<div class="cont">
			<h1 style="font-family: Verdana">Curso Node.js </h1>
			<p style="font-family: verdana">Tàdel Formació</p>
		</div>
	</div>
	<br>
	<br>
	<div class="cont">
		<h3 id="indice">Índice</h3>
		<ul>
			<li><a href="#contacto">Contacto y enlaces al curso</a></li>
			<li><a href="#recursos">Recursos Node.js</a></li>
			<li><a href="#otros">Otros recursos</a></li>
			<li><a href="#comandos">Comandos básicos</a></li>
			<li><a href="#inicio">Iniciar un servidor</a></li>
			<li><a href="#rutas">Enrutamiento</a></li>
			<li><a href="#servidor">Interacción con bases de datos</a></li>
			<li><a href="#paquetes">Paquetes instalados</a></li>
			<li><a href="#prueba">Pruebas y ejercicios</a></li>
		</ul><br>

		<h3 id="contacto">Contacto y enlaces al curso</h3>
		<p>
			<a href="http://certificats.tadelformacio.com">Accés a la formació online de Tàdel Formació</a><br>
			<a href="https://pablomonteserin.com/curso/nodejs/">Curso Node.js de Pablo Monteserín</a> (más ejercicios con bases de datos <a href="https://pablomonteserin.com/curso/java-mvc/">aquí</a>)<br>
			
			<a href="http://pablomonteserin.com/termine">Aplicación Terminé (para clase)</a><br>
			<a href="mailto:pablomonteserin@pablomonteserin.com">pablomonteserin@pablomonteserin.com</a><br>
		</p>
		<br>
		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="recursos">Recursos Node.js</h3>
		<p>
			<a href="https://www.w3schools.com/nodejs/">w3c Schools</a>: curso de W3C de Node.js <br>
			<a href="https://nodejs.org/es/download/">Descarga Node.js</a>: para instalar Node.js en el ordenador <br>
		</p><br>

		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="recursos">Otros recursos</h3>
		<p>
			<a href="https://git-scm.com/">GIT</a>: instalador para usar GitHub y similares <br>
			<a href="https://www.apachefriends.org/es/index.html">Xampp</a>: para montar un servidor local (para las bases de datos MySQL)<br>
			<a href="https://build.phonegap.com/">Adobe PhoneGap</a>: para generar apps Android a partir de un paquete ZIP <br>
		</p><br>
		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="comandos">Comandos básicos</h3>

		<p>Usaremos la consola de GitHub para ejecutar los comandos directamente desde la carpeta de origen:</p>

		<p><code>node</code> sirve para ejecutar cualquier archivo en el servidor.</p>

		<p><code>node init</code> inicializa un nuevo proyecto en la carpeta en la que estamos trabajando.</p>

		<p><code>npm i</code> o <code>npm install</code> sirven para instalar paquetes (librerías) en el proyecto. Se puede poner el nombre del paquete a continuación o meterlos en el apartado <i>dependences</i> del <i>package.json</i> (el archivo de configuración del proyecto con formato <u>J</u>ava<u>s</u>cript <u>O</u>bject <u>N</u>otation) que se genera al inicializar el proyecto. Si añadimos <code>--g</code> al final del comando, el paquete se instala en el sistema operativo en lugar de en el proyecto, permitiendo usarlo desde cualquier proyecto.</p>

		<p><code>npm start</code> arranca el proyecto desde el que hayamos ejecutado la consola. Accederemos a la aplicación escribiendo <i>localhost:3000</i> en la barra del navegador (3000 es el puerto por defecto, que se puede consultar en el archivo <i>www</i> de la carpeta <i>bin</i>).</p>

		<p><code>express nombre-del-proyecto --hbs</code> crea un proyecto nuevo usando el paquete <i>Express</i> (más información sobre el paquete abajo).</p>
		<br>
		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="inicio">Iniciar un servidor</h3>
		
		<p>Los pasos para iniciar un servidor con Node.js son los siguientes:</p>
		<ol style="padding-left: 70px;">
			<li>Crear el proyecto con <code>express nombre-del-proyecto --hbs</code>.</li>
			<li>Cambiar a la carpeta del proyecto con <code>cd nombre-del-proyecto</code>.</li>
			<li>Instalar los paquetes predefinidos por <i>Express</i> con <code>npm install</code>.</li>
			<li>Instalar el paquete <i>Nodemon</i> con <code>npm install nodemon</code></li>
			<li>Cambiar la línea <span class="text">"start": "node ./bin/www"</span> por <span class="text">"start": "nodemon ./bin/www"</span> en el archivo <i>package.json</i>.</li>
			<li>Iniciar el servidor con <code>npm start</code>.</li>
			<li>Acceder al servidor escribiendo <span class="text">localhost:3000</span> en la barra de direcciones del navegador.</li>
		</ol>
		<p>Posibles errores:</p> 
		<ul style="padding-left: 70px;">
			<li><i>El puerto 3000 está ocupado</i>: hay que cambiar el puerto en el archivo <i>www</i> de la carpeta <i>bin</i>.</li>
			<li><i>No se encuentra el paquete XXX</i>: no se han instalado los paquetes (paso 3).</li>
		</ul>
		<p>El servidor iniciado con el paquete <i>Nodemon</i> se cierra con <code>npm stop</code> o haciendo <i>Ctrl+C</i>.</p>

		<br>

		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="rutas">Enrutamiento</h3>
		<p>
			Los archivos de enrutamiento están contenidos en la carpeta <i>routes</i> y tienen que estár referenciados en el archivo <i>app.js</i> con el código siguiente:
		</p>

		<pre><div class="code">
<span class="text">var ejemploRouter = require('./routes/ejemplo');
app.use('/ejemplo', ejemploRouter);</span>
			</div></pre>

		<p>Dentro del archivo enrutador están definidas las diferentes urls a las que hace referencia con el siguiente formato:</p>

		<pre><div class="code">
<span class="text">var express = require('express');
var router = express.Router();

router.get('/', function(req, res, next) {
  res.render('ejemplos');
});

router.get('/amor', function(req, res, next) {
  res.render('index', {title: 'Amor'});
});

router.get('/omar', function(req, res, next) {
  res.send('Omar Olmedo Ferrer');
});

router.get('/libros', function(req, res, next) {
  const biblioteca = [
    {
      "titulo": "La Aventura",
      "autor": "Paco"
    },
    {
      "titulo":"Las Cosas",
      "autor": "Pepe"
    }
  ];
  res.send(biblioteca);
});

module.exports = router;</span>
		</div></pre>
		<p>El método <i>res.render(view,{data: "thing"})</i> carga la vista <i>view</i> de la carpeta <i>views</i> y la variable <i>{data: "thing"}</i> envía datos que se pueden referenciar usando <i>{{data}}</i> en la vista, que mostrará <i>thing</i>.</p>

		<p>El método <i>res.send(thing)</i> se usa para enviar directamente al navegador lo que contenga, sea texto, números, variables, objetos, etc.</p>

		<p>Para obtener el contenido de un archivo se usa el método <i>require("ruta_del_archivo")</i>.</p>

		<p>A las páginas enrutadas en el ejemplo anterior se accederia desde las urls <i>localhost:3000/ejemplos</i>, <i>/amor</i>, <i>/omar</i> y <i>/libros</i>, respectivamente.</p>

		<p>A los archivos de la carpeta <i>public</i> se puede acceder directamente desde la raíz. Por ejemplo, se puede acceder directamente a la imagen <i>amor.png</i> de la carpeta <i>public/images</i> escribiendo <i>localhost:3000/images/amor.png</i>.</p>

		<br>
		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="servidor">Interacción con bases de datos</h3>
		<p>Servidor MySQL en Xampp</p>
		<p>Acceso del servidor a la base de datos + CODIGO</p>
		<p>Añadir una entrada a la base de datos + CODIGO</p>
		<p>Modificar una entrada a la base de datos + CODIGO</p>
		<p>Eliminar una entrada a la base de datos + CODIGO</p>
		<p>Consultar la base de datos + CODIGO</p>
		<br>
		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="paquetes">Paquetes instalados</h3>

		<p><code>npm install express-generator</code> (instalado globalmente). Lo usaremos con <code>express amor --hbs</code> para crear un proyecto llamado <i>amor</i> (el <code>--hbs</code> indica que hay librerías que hay que instalar con <code>npm install</code>.</p>

		<p><code>npm install nodemon</code>. Sirve para reiniciar el servidor cada vez que guardemos un cambio en un archivo, así no hay que reiniciarlo manualmente. Hay que cambiar la línea <span class="text">"start": "node ./bin/www"</span> por <span class="text">"start": "nodemon ./bin/www"</span> en el archivo <i>package.json</i>.</p>

		<p><code>npm install mysql</code>. Instala el sistema de gestión de bases de datos MySQL</p>
		<br>
		<p><a href="#indice">Volver al índice</a></p><br>



		<h3 id="prueba">Pruebas y ejercicios</h3>
		<p>
			<a href="planetas.html">Planetas</a>: página que coge datos de un <i>.json</i> contenido en el servidor <br>
			<a href="formulario_database.html">Escalas y acordes</a>: formulario de acceso a una base de datos (alta, baja, modificación y consulta) <br>
			<a href="formulario_asistentes/index.html">AsistenciApp</a>: formulario de acceso a una base de datos con diferentes URLs (alta, baja y consulta) <br>
		</p>
		<br>
		<p><a href="#indice">Volver al índice</a></p><br>

		<p style="font-size: .8em; padding: 0">© 2019 - Omar Olmedo Ferrer</p>
	</div>
</body>
</html>